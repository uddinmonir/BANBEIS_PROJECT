function [X,k,m] = logm_Custom(A)


e = eigs(A);
if any( imag(e) == 0 & real(e) <= 0 )
   error('The matrix must not have any nonpositive real eigenvalues!')
end

n = length(A);

paderr = [1.10034304462528e-05;0.00181861753366255;0.0162062847950157;0.0538735326313813;0.113528022676287;0.186628606135413;0.264296083111144;0.340217233198530;0.410823500055682;0.474552125600777;0.531066752117846;0.580688713344168;0.624041434401292;0.661848256307141;0.694826617248935;0.723638270143729;0.748870293092631;0.771032082515181;0.790560007492567;0.807825219805085;0.823142281401079;0.836777469614778;0.848956266157677;0.859869872373720;0.869680759765733;0.878527339751219;0.886527863552715;0.893783665982492;0.900381858563124;0.906397564754575;0.911895776502435;0.916932898528787;0.921558035437599;0.925814066983505;0.929738548697752;0.933364468315142;0.936720882905026;0.939833457084148;0.942724919003942;0.945415447807542;0.947923003814605;0.950263610709011;0.952451597389187;0.954499805822829;0.956419770170386;0.958221871559014;0.959915472163851;0.961509031656881;0.963010208591225;0.964425948881359;0.965762563201802;0.967025794845780;0.968220879351023;0.969352597003907;0.970425319168965;0.971443049252779;0.972409458995046;0.973327920681458;0.974201535789918;0.975033160511162;0.975825428524854;0.976580771361138;0.977301436633959;0.977989504395085];

X = A;
k = 0;
p = 0; 
itk = 5;

while 1

    difference = norm(X-eye(n),1);
    if difference <= paderr(16)

       p = p+1;
       j1 = find(difference <= paderr(3:16));
       j1 = j1(1) + 2;
       j2 = find(difference/2 <= paderr(3:16));
       j2 = j2(1) + 2;
       if 2*(j1-j2)/3 < itk || p == 2
           m = j1; 
           fprintf('Congratulation ! Convergent Solution found\n')
           break;
       end

    end
     fprintf('Searching for Convergent Solution. Be Patient...\n')
    [X,~,itk] = sqrtm_DenBea(X); 
    k = k+1;

end
fprintf('Pade Rational Constant: %d \n',m)
X = 2^k*logm_pade(X-eye(n),m);
if isreal(A)
    X = real(X); 
end

end
